# ğŸ—ï¸ Agent Architecture

> Auto-generated from `NodeRegistry` contracts

---

## ğŸ“¦ State Slices

State is organized into isolated **slices** for separation of concerns.

```mermaid
erDiagram
    REQUEST["ğŸ”µ request"] {
        string action
        string message
        object params
    }
    CONTEXT["ğŸŸ¢ context"] {
        object user_profile
        array history
        object metadata
    }
    TASK["ğŸŸ£ task"] {
        object current_task
        array completed_items
    }
    RESPONSE["ğŸŸ  response"] {
        string response_type
        string message
        object data
    }
    
    REQUEST ||--o{ CONTEXT : "triggers"
    CONTEXT ||--o{ TASK : "populates"
    TASK ||--|| RESPONSE : "generates"
```

<details>
<summary>ğŸ“‹ Slice Details</summary>

| Slice | Purpose | Key Fields |
|:------|:--------|:-----------|
| `request` | User input | `action`, `message`, `params` |
| `context` | Session context | `user_profile`, `history`, `metadata` |
| `task` | Task state | `current_task`, `completed_items` |
| `response` | API Response | `response_type`, `message`, `data` |

</details>

---

## ğŸ¯ System Hierarchy

```mermaid
flowchart TB
    subgraph root["ğŸŒ Entry Point"]
        router["ğŸš¦ Router"]
    end
    
    subgraph main["ğŸ¯ Main Supervisor"]
        direction LR
        greeter["ï¿½ greeter"]
        helper["ğŸ’¡ helper"]
        analyzer["ï¿½ analyzer"]
    end
    
    subgraph task["ğŸ“‹ Task Supervisor"]
        direction LR
        planner["ï¿½ planner"]
        executor["âš™ï¸ executor"]
        reporter["ğŸ“„ reporter"]
    end
    
    router --> main
    router --> task
    main -.->|"task ready"| task
    
    classDef supervisor fill:#1a1a2e,stroke:#16213e,color:#fff
    classDef node fill:#0f3460,stroke:#16213e,color:#fff
    classDef terminal fill:#e94560,stroke:#16213e,color:#fff
    
    class main,task supervisor
    class greeter,helper,analyzer,planner,executor node
    class reporter terminal
```

---

## ğŸ”€ Data Flow

> Arrows show which slices nodes **read** and **write**

```mermaid
flowchart LR
    subgraph slices["State Slices"]
        req[("ğŸ“¥ request")]
        ctx[("ï¿½ï¸ context")]
        tsk[("ğŸ“‹ task")]
        resp[("ğŸ“¤ response")]
    end
    
    subgraph nodes["Nodes"]
        greeter["greeter"]
        helper["helper"]
        executor["executor"]
    end
    
    req --> greeter
    greeter --> ctx
    greeter --> resp
    
    req --> helper
    ctx --> helper
    helper --> tsk
    
    tsk --> executor
    executor --> resp
    
    style req fill:#3498db,stroke:#2980b9,color:#fff
    style ctx fill:#2ecc71,stroke:#27ae60,color:#fff
    style tsk fill:#9b59b6,stroke:#8e44ad,color:#fff
    style resp fill:#e67e22,stroke:#d35400,color:#fff
```

---

## âš¡ Trigger Hierarchy

> Nodes are evaluated by **priority** (highest first)

### ğŸ¯ Main Supervisor

| Priority | Node | Condition | Hint |
|:--------:|:-----|:----------|:-----|
| ğŸ”´ **100** | `greeter` | `request.action == "greet"` | Handle greeting |
| ğŸŸ¡ **50** | `analyzer` | `context.needs_analysis == true` | Run analysis |
| ğŸŸ¢ **10** | `helper` | _(default)_ | General assistance |

```mermaid
flowchart TD
    subgraph priority["Priority Chain"]
        direction TB
        p100["ğŸ”´ 100: greeter<br/><small>when: action=greet</small>"]
        p50["ğŸŸ¡ 50: analyzer<br/><small>when: needs_analysis</small>"]
        p10["ğŸŸ¢ 10: helper<br/><small>default fallback</small>"]
    end
    
    p100 -->|"not matched"| p50
    p50 -->|"not matched"| p10
    
    style p100 fill:#e74c3c,stroke:#c0392b,color:#fff
    style p50 fill:#f39c12,stroke:#d68910,color:#fff
    style p10 fill:#27ae60,stroke:#1e8449,color:#fff
```

---

## ğŸ“š Nodes Reference

| Node | Supervisor | Reads | Writes | LLM | Terminal |
|:-----|:-----------|:------|:-------|:---:|:--------:|
| `greeter` | main | `request` | `context`, `response` | âœ… | |
| `helper` | main | `request`, `context` | `task`, `response` | âœ… | |
| `analyzer` | main | `context` | `context` | âœ… | |
| `planner` | task | `request`, `task` | `task` | âœ… | |
| `executor` | task | `task` | `task`, `response` | | |
| `reporter` | task | `task` | `response` | âœ… | ğŸ”š |

<details>
<summary>ğŸ” Legend</summary>

- âœ… = Requires LLM
- ğŸ”š = Terminal node (exits to END)
- Reads/Writes = State slices accessed

</details>

---

<sub>Generated by `agent-contracts` visualizer</sub>
