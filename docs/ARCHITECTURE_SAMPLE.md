# ğŸ—ï¸ Agent Architecture

> Auto-generated from `NodeRegistry` contracts

---

## ğŸ“¦ State Slices

State is organized into isolated **slices** for separation of concerns.

| Slice | Read By | Written By |
|:------|:--------|:-----------|
| `request` | `greeter`, `helper`, `analyzer` +3 | - |
| `context` | `helper`, `analyzer`, `planner` | `greeter`, `analyzer` |
| `task` | `planner`, `executor`, `reporter` | `helper`, `planner`, `executor` |
| `response` | - | `greeter`, `helper`, `executor` +1 |

<details>
<summary>ğŸ“Š Slice Relationships</summary>

```mermaid
erDiagram
    REQUEST ||--o{ CONTEXT : "3 nodes"
    REQUEST ||--o{ TASK : "2 nodes"
    CONTEXT ||--o{ TASK : "2 nodes"
    CONTEXT ||--o{ RESPONSE : "2 nodes"
    TASK ||--o{ RESPONSE : "3 nodes"
```

</details>

---

## ğŸ¯ System Hierarchy

```mermaid
flowchart TB
    subgraph main["ğŸ¯ Main Supervisor"]
        direction LR
        greeter["ğŸ‘‹ greeter"]
        helper["ğŸ’¡ helper"]
        analyzer["ğŸ“Š analyzer"]
    end
    
    subgraph task_sup["ğŸ“‹ Task Supervisor"]
        direction LR
        planner["ğŸ“ planner"]
        executor["âš™ï¸ executor"]
        reporter["ğŸ“„ reporter"]
    end

    classDef terminal fill:#e94560,stroke:#16213e,color:#fff
    class reporter terminal
```

---

## ğŸ”€ Data Flow

> Key data paths through the system

```mermaid
flowchart TB
    subgraph slices["ğŸ“¦ State"]
        request[("ğŸ“¥ request")]
        context[("ğŸ“ context")]
        task_slice[("ğŸ“ task")]
        response[("ğŸ“¤ response")]
    end

    subgraph main["ğŸ¯ main"]
        direction LR
        greeter["ğŸ‘‹ greeter"]
        helper["ğŸ’¡ helper"]
        analyzer["ğŸ“Š analyzer"]
    end
    subgraph task_sup["ğŸ¯ task"]
        direction LR
        planner["ğŸ“ planner"]
        executor["âš™ï¸ executor"]
        reporter["ğŸ”š reporter"]
    end

    %% Entry points
    request --> greeter
    request --> helper
    request --> planner
    %% Terminal outputs
    reporter --> response
    %% Cross-supervisor data
    main -->|context| context
    context --> task_sup

    classDef slice fill:#f5f5f5,stroke:#999
    classDef terminal fill:#e94560,stroke:#16213e,color:#fff
    class reporter terminal
```

<details>
<summary>ğŸ“Š Detailed Node Dependencies</summary>

**main**

| Node | Depends On (via shared slices) |
|:-----|:-------------------------------|
| `helper` | `greeter` (context), `analyzer` (context) |
| `analyzer` | `greeter` (context) |

**task**

| Node | Depends On (via shared slices) |
|:-----|:-------------------------------|
| `executor` | `helper` (task), `planner` (task) |
| `reporter` | `helper` (task), `planner` (task), `executor` (task) |

</details>

---

## âš¡ Trigger Hierarchy

> Nodes are evaluated by **priority** (highest first)

### ğŸ¯ Main Supervisor

| Priority | Node | Condition | Hint |
|:--------:|:-----|:----------|:-----|
| ğŸ”´ **100** | `greeter` | `request.action=greet` | Handle greeting |
| ğŸŸ¡ **50** | `analyzer` | `context.needs_analysis=true` | Run analysis |
| ğŸŸ¢ **10** | `helper` | _(default)_ | General assistance |

<details>
<summary>ğŸ“Š main Priority Chain</summary>

```mermaid
flowchart TD
    subgraph main["main"]
        direction TB
        greeter["ğŸ”´ P100: greeter"]
        analyzer["ğŸŸ¡ P50: analyzer"]
        greeter -->|"not matched"| analyzer
        helper["ğŸŸ¢ P10: helper"]
        analyzer -->|"not matched"| helper
    end
```

</details>

### ğŸ¯ Task Supervisor

| Priority | Node | Condition | Hint |
|:--------:|:-----|:----------|:-----|
| ğŸŸ¡ **80** | `planner` | `task.needs_planning=true` | Create plan |
| ğŸŸ¡ **50** | `executor` | `task.plan_ready=true` | Execute tasks |
| ğŸŸ¢ **30** | `reporter` | `task.execution_done=true` | Generate report |

<details>
<summary>ğŸ“Š task Priority Chain</summary>

```mermaid
flowchart TD
    subgraph task["task"]
        direction TB
        planner["ğŸŸ¡ P80: planner"]
        executor["ğŸŸ¡ P50: executor"]
        planner -->|"not matched"| executor
        reporter["ğŸŸ¢ P30: reporter"]
        executor -->|"not matched"| reporter
    end
```

</details>

---

## ğŸ“š Nodes Reference

| Node | Supervisor | Reads | Writes | LLM | Terminal |
|:-----|:-----------|:------|:-------|:---:|:--------:|
| `analyzer` | main | `context` | `context` | âœ… | |
| `executor` | task | `task` | `task`, `response` | | |
| `greeter` | main | `request` | `context`, `response` | âœ… | |
| `helper` | main | `request`, `context` | `task`, `response` | âœ… | |
| `planner` | task | `request`, `task` | `task` | âœ… | |
| `reporter` | task | `task` | `response` | âœ… | ğŸ”š |

<details>
<summary>ğŸ” Legend</summary>

- âœ… = Requires LLM
- ğŸ”š = Terminal node (exits to END)
- Reads/Writes = State slices accessed

</details>

---

<sub>Generated by `agent-contracts` visualizer</sub>
